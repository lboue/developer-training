"use strict";(self.webpackChunkgolioth_developer_training=self.webpackChunkgolioth_developer_training||[]).push([[906],{3905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>c});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},m=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,m=i(e,["components","mdxType","originalType","parentName"]),d=p(a),c=o,h=d["".concat(s,".").concat(c)]||d[c]||u[c]||r;return a?n.createElement(h,l(l({ref:t},m),{},{components:a})):n.createElement(h,l({ref:t},m))}));function c(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,l=new Array(r);l[0]=d;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:o,l[1]=i;for(var p=2;p<r;p++)l[p]=a[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},5162:(e,t,a)=>{a.d(t,{Z:()=>l});var n=a(7294),o=a(6010);const r="tabItem_Ymn6";function l(e){let{children:t,hidden:a,className:l}=e;return n.createElement("div",{role:"tabpanel",className:(0,o.Z)(r,l),hidden:a},t)}},5488:(e,t,a)=>{a.d(t,{Z:()=>c});var n=a(7462),o=a(7294),r=a(6010),l=a(2389),i=a(7392),s=a(7094),p=a(2466);const m="tabList__CuJ",u="tabItem_LNqP";function d(e){var t;const{lazy:a,block:l,defaultValue:d,values:c,groupId:h,className:g}=e,k=o.Children.map(e.children,(e=>{if((0,o.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),f=c??k.map((e=>{let{props:{value:t,label:a,attributes:n}}=e;return{value:t,label:a,attributes:n}})),y=(0,i.l)(f,((e,t)=>e.value===t.value));if(y.length>0)throw new Error(`Docusaurus error: Duplicate values "${y.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const b=null===d?d:d??(null==(t=k.find((e=>e.props.default)))?void 0:t.props.value)??k[0].props.value;if(null!==b&&!f.some((e=>e.value===b)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${b}" but none of its children has the corresponding value. Available values are: ${f.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:w,setTabGroupChoices:v}=(0,s.U)(),[N,T]=(0,o.useState)(b),x=[],{blockElementScrollPositionUntilNextRender:_}=(0,p.o5)();if(null!=h){const e=w[h];null!=e&&e!==N&&f.some((t=>t.value===e))&&T(e)}const C=e=>{const t=e.currentTarget,a=x.indexOf(t),n=f[a].value;n!==N&&(_(t),T(n),null!=h&&v(h,String(n)))},M=e=>{var t;let a=null;switch(e.key){case"Enter":C(e);break;case"ArrowRight":{const t=x.indexOf(e.currentTarget)+1;a=x[t]??x[0];break}case"ArrowLeft":{const t=x.indexOf(e.currentTarget)-1;a=x[t]??x[x.length-1];break}}null==(t=a)||t.focus()};return o.createElement("div",{className:(0,r.Z)("tabs-container",m)},o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":l},g)},f.map((e=>{let{value:t,label:a,attributes:l}=e;return o.createElement("li",(0,n.Z)({role:"tab",tabIndex:N===t?0:-1,"aria-selected":N===t,key:t,ref:e=>x.push(e),onKeyDown:M,onClick:C},l,{className:(0,r.Z)("tabs__item",u,null==l?void 0:l.className,{"tabs__item--active":N===t})}),a??t)}))),a?(0,o.cloneElement)(k.filter((e=>e.props.value===N))[0],{className:"margin-top--md"}):o.createElement("div",{className:"margin-top--md"},k.map(((e,t)=>(0,o.cloneElement)(e,{key:t,hidden:e.props.value!==N})))))}function c(e){const t=(0,l.Z)();return o.createElement(d,(0,n.Z)({key:String(t)},e))}},6277:(e,t,a)=>{a.d(t,{ZP:()=>l});var n=a(7462),o=(a(7294),a(3905));const r={toc:[]};function l(e){let{components:t,...a}=e;return(0,o.kt)("wrapper",(0,n.Z)({},r,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"Credentials allow your device to authenticate onto your local Wi-Fi\nnetwork and then to talk to the Golioth servers.")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Option 1"),": Reuse ",(0,o.kt)("inlineCode",{parentName:"p"},"credentials.conf")," from previous examples")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Option 2"),": Make a new ",(0,o.kt)("inlineCode",{parentName:"p"},"credentials.conf")," (required if this is the first\nexample you are running)"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Make a copy of ",(0,o.kt)("inlineCode",{parentName:"p"},"credentials.conf_example")," and name it ",(0,o.kt)("inlineCode",{parentName:"p"},"credentials.conf")),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre"},"cp credentials.conf_example credentials.conf\n"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Edit this new file to include your WiFi credentials and the PSK-ID/PSK\nfrom the device page on your Golioth console"))))))}l.isMDXComponent=!0},7009:(e,t,a)=>{a.d(t,{ZP:()=>l});var n=a(7462),o=(a(7294),a(3905));const r={toc:[]};function l(e){let{components:t,...l}=e;return(0,o.kt)("wrapper",(0,n.Z)({},r,l,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("br",null),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Show me how to download from Kasm"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"How to download binaries from Kasm",src:a(1403).Z,width:"1216",height:"745"})),(0,o.kt)("p",null,"Because Kasm is a virtual machine running in the cloud, we can not directly program the MagTag connected to your local machine. Instead, we will download the binary so that your local machine can program that file to the MagTag in the next step."),(0,o.kt)("p",null,"The filename includes the folder name of the app you built, along with a\ntimestamp. So your download will look something like this:\n",(0,o.kt)("inlineCode",{parentName:"p"},"merged_golioth-demo_213729.bin"),"."),(0,o.kt)("p",null,'The image above shows the left sidebar menu of Kasm with the Download widget selected. Click the "DOWNLOAD" button next to the ',(0,o.kt)("inlineCode",{parentName:"p"},"merged_<appfolder>_<hhmmss>.bin")," file to download your recently compiled code.")))}l.isMDXComponent=!0},873:(e,t,a)=>{a.d(t,{ZP:()=>s});var n=a(7462),o=(a(7294),a(3905)),r=a(5488),l=a(5162);const i={toc:[]};function s(e){let{components:t,...s}=e;return(0,o.kt)("wrapper",(0,n.Z)({},i,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Use the USB cable to plug the MagTag into your local computer. Ensure the\npower switch is in the 'On' position.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Put the MagTag into DFU bootloader mode"),(0,o.kt)("ol",{parentName:"li"},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Hold down the Boot0 button")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Press and release the Reset button"),(0,o.kt)("p",{parentName:"li"},(0,o.kt)("img",{alt:"MagTag Boot0 and Reset buttons",src:a(8606).Z,width:"1000",height:"643"})))))),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Run the flash command on your local machine:"),(0,o.kt)(r.Z,{groupId:"os",defaultValue:"linux",values:[{label:"Linux/MacOS",value:"linux"},{label:"Windows",value:"windows"}],mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"linux",mdxType:"TabItem"},(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre"},"cd ~/Downloads\nesptool.py --chip esp32s2 --port /dev/ttyACM0 write_flash 0x0 merged_<appfolder>_<hhmmss>.bin\n"))),(0,o.kt)(l.Z,{value:"windows",mdxType:"TabItem"},(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre"},"cd %HOMEPATH%/Downloads\npython -m esptool --chip esp32s2 --port com3 write_flash 0x0 merged_<appfolder>_<hhmmss>.bin\n")),(0,o.kt)("admonition",{parentName:"li",type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"The port for your MagTag may be different from the ",(0,o.kt)("inlineCode",{parentName:"p"},"com3")," shown above.\nFind this value in the Device Manager. Here's ",(0,o.kt)("a",{parentName:"p",href:"https://www.loom.com/share/cde8204ea8b341d892f6ad21ed43ac82"},"a video walkthrough of the\nprocess"),"."))))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Press the MagTag ",(0,o.kt)("strong",{parentName:"p"},"Reset")," button to start the new firmware"))),(0,o.kt)("br",null),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"If the flash is successful, ",(0,o.kt)("strong",{parentName:"p"},"you will receive an error message")," telling you that you must manually reset the device. Remember to press the reset button to run the newly flashed program. ",(0,o.kt)("a",{parentName:"p",href:"/docs/zephyr-intro/zephyr-tips#you-must-press-the-reset-button-after-flashing-firmware"},"Learn more about this"),"."),(0,o.kt)("p",{parentName:"admonition"},"On some machines you will only have a few seconds to run the ",(0,o.kt)("inlineCode",{parentName:"p"},"esptool.py")," command after entering bootloader mode. ",(0,o.kt)("a",{parentName:"p",href:"/docs/zephyr-intro/zephyr-tips#errors-with-west-build-zephyr-tree-and-esp32-environmental-variables"},"Learn more about this"),".")))}s.isMDXComponent=!0},1018:(e,t,a)=>{a.d(t,{ZP:()=>p});var n=a(7462),o=(a(7294),a(3905)),r=a(5488),l=a(5162),i=a(873);const s={toc:[]};function p(e){let{components:t,...a}=e;return(0,o.kt)("wrapper",(0,n.Z)({},s,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Put the MagTag into DFU bootloader mode (Hold Boot0, tap Reset)")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Change to the download directory and run the flash command on your local machine:"),(0,o.kt)(r.Z,{groupId:"os",defaultValue:"linux",values:[{label:"Linux/MacOS",value:"linux"},{label:"Windows",value:"windows"}],mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"linux",mdxType:"TabItem"},(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre"},"cd ~/Downloads\nesptool.py --chip esp32s2 --port /dev/ttyACM0 write_flash 0x0 merged_<appfolder>_<hhmmss>.bin\n"))),(0,o.kt)(l.Z,{value:"windows",mdxType:"TabItem"},(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre"},"cd %HOMEPATH%/Downloads\npython -m esptool --chip esp32s2 --port com3 write_flash 0x0 merged_<appfolder>_<hhmmss>.bin\n"))))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Press the MagTag ",(0,o.kt)("strong",{parentName:"p"},"Reset")," button to start the new firmware"))),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Click to reveal full firmware update instructions"),(0,o.kt)(i.ZP,{mdxType:"VerbostDownloadFlash"})))}p.isMDXComponent=!0},8705:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>u,contentTitle:()=>p,default:()=>h,frontMatter:()=>s,metadata:()=>m,toc:()=>d});var n=a(7462),o=(a(7294),a(3905)),r=a(6277),l=a(7009),i=a(1018);const s={sidebar_position:3},p="Exercise: MagTag as a name tag",m={unversionedId:"after-training/magtag-nametag",id:"after-training/magtag-nametag",title:"Exercise: MagTag as a name tag",description:"The great thing about ePaper is that it continues to display content after power",source:"@site/docs/after-training/magtag-nametag.md",sourceDirName:"after-training",slug:"/after-training/magtag-nametag",permalink:"/docs/after-training/magtag-nametag",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"After Training",permalink:"/docs/category/after-training"},next:{title:"Install Zephyr on Your Local Machine",permalink:"/docs/after-training/local-toolchain-install"}},u={},d=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Desired Outcome",id:"desired-outcome",level:3},{value:"Time Estimate",id:"time-estimate",level:3},{value:"Workflow",id:"workflow",level:2},{value:"Build in the Kasm container",id:"build-in-the-kasm-container",level:3},{value:"Update MagTag firmware from your local machine",id:"update-magtag-firmware-from-your-local-machine",level:3},{value:"Setup the LightDB State endpoints",id:"setup-the-lightdb-state-endpoints",level:2},{value:"Expected Results",id:"expected-results",level:2},{value:"Challenge: Use a custom background",id:"challenge-use-a-custom-background",level:2},{value:"Design your own background",id:"design-your-own-background",level:3},{value:"Upload and convert to a header file",id:"upload-and-convert-to-a-header-file",level:3},{value:"Show the header file and write your tex",id:"show-the-header-file-and-write-your-tex",level:3},{value:"Build and flash your changes",id:"build-and-flash-your-changes",level:3}],c={toc:d};function h(e){let{components:t,...s}=e;return(0,o.kt)("wrapper",(0,n.Z)({},c,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"exercise-magtag-as-a-name-tag"},"Exercise: MagTag as a name tag"),(0,o.kt)("p",null,"The great thing about ePaper is that it continues to display content after power\nis removed from the board. This makes the MagTag a great name tag to wear at\nconferences and other live events."),(0,o.kt)("p",null,"In this exercise you'll turn your MagTag into a name tag by pulling in name,\ncompany, and social media handle via Golioth. Optionally, you'll learn how to\ngenerate your own images for the display, and place text on them."),(0,o.kt)("h2",{id:"learning-objectives"},"Learning Objectives"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Include image data in a build using header files"),(0,o.kt)("li",{parentName:"ol"},"Manipulate on-screen text")),(0,o.kt)("h3",{id:"desired-outcome"},"Desired Outcome"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"By the end of this section you will have an ePaper name tag to wear at live\nevents")),(0,o.kt)("h3",{id:"time-estimate"},"Time Estimate"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"15-20 minutes")),(0,o.kt)("h2",{id:"workflow"},"Workflow"),(0,o.kt)("h3",{id:"build-in-the-kasm-container"},"Build in the Kasm container"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"In the Kasm container, go to your local copy of ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/golioth/magtag-demo"},"the magtag-demo repository"),"."),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"cd ~/Desktop/magtag-training/app\n"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Create a file for WiFi and Golioth credentials"),(0,o.kt)(r.ZP,{mdxType:"CreateCredentials"})),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Build the example, including the credentials file you just created"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"west build -b esp32s2_saola nametag -p\n"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Download the binary"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Run ",(0,o.kt)("inlineCode",{parentName:"li"},"west kasm download")," to package the compiled code and make it\navailable for download"),(0,o.kt)("li",{parentName:"ul"},"Use the Download option in Kasm's left sidebar to download\n",(0,o.kt)("inlineCode",{parentName:"li"},"merged_<appfolder>_<hhmmss>.bin")," to your local machine.")),(0,o.kt)(l.ZP,{mdxType:"HowToDownload"}))),(0,o.kt)("h3",{id:"update-magtag-firmware-from-your-local-machine"},"Update MagTag firmware from your local machine"),(0,o.kt)(i.ZP,{mdxType:"HowToFlash"}),(0,o.kt)("h2",{id:"setup-the-lightdb-state-endpoints"},"Setup the LightDB State endpoints"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Go to the Golioth Console and choose Management","\u2192","Devices from the sidebar\nmenu")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click on the name of your device to enter the device view, then click the\nLightDB State icon which opens the LightDB State tab")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Hover your mouse over the empty JSON object and click the green plus sign\nthat is revealed"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},'If the JSON object is not empty (e.g. data from previous examples are\nshown), use the "Clean" button to delete all items'))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Type in ",(0,o.kt)("inlineCode",{parentName:"p"},"name")," as the key name (no quotes) and press enter")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Hover over ",(0,o.kt)("inlineCode",{parentName:"p"},"NULL")," and click the green pencil icon to edit the value, replace\n",(0,o.kt)("inlineCode",{parentName:"p"},"NULL")," with your name and click the green check mark to save it.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},'Repeat steps 4 and 5 for "title" and "handle" endpoints.')),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Important"),': Click the "Submit" button at the bottom right of this dialog\nto save your changes.'),(0,o.kt)("p",{parentName:"li"},"  ",(0,o.kt)("img",{alt:"LightDB State endpoints",src:a(9501).Z,width:"692",height:"331"})))),(0,o.kt)("h2",{id:"expected-results"},"Expected Results"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"MagTag name tag",src:a(2929).Z,width:"3160",height:"2140"})),(0,o.kt)("p",null,'At power up, you will be asked if you want to update your the badge information\nfrom Golioth. When you choose "YES", the MagTag will attempt to connect to a\nWiFi network and request data from Golioth. When successful, the epaper screen\nwill automatically refresh with the new name/title/handle. Pressing any of the\nfour buttons will cycle through different display layouts.'),(0,o.kt)("p",null,'If you choose "NO" at boot time, the name tag will enter into display mode using\nstored information, and once again the layout may be chosen with the buttons.'),(0,o.kt)("admonition",{title:"Persistent storage coming soon",type:"note"},(0,o.kt)("p",{parentName:"admonition"},"At this time, name information downloaded from Golioth will be lost between\npower cycles. However, it is possible to store persistent settings using the\nZephyr Settings subsystem. This feature will be available soon."),(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("strong",{parentName:"p"},"Pro-level challenge:")," Add persistent storage and submit a pull request!")),(0,o.kt)("h2",{id:"challenge-use-a-custom-background"},"Challenge: Use a custom background"),(0,o.kt)("p",null,"Design your own background and layout for the MagTag! To accomplish this:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Create a 296x128 image file in the XBM format"),(0,o.kt)("li",{parentName:"ol"},"Upload the header to Kasm, include it in your code"),(0,o.kt)("li",{parentName:"ol"},"Use the helper script to convert from XBM to a c header file"),(0,o.kt)("li",{parentName:"ol"},"Show the header and write text over the top of it.")),(0,o.kt)("h3",{id:"design-your-own-background"},"Design your own background"),(0,o.kt)("p",null,"We recommend using ",(0,o.kt)("a",{parentName:"p",href:"https://www.gimp.org/"},"GNU Image Manipulation Program\n(GIMP)")," or any other graphics program that can save files\nas XBM (X BitMap)."),(0,o.kt)("p",null,"Size and crop your image to 296x128 pixels. You can use color images and Gimp\nwill do its best to convert to black and white when saving as XBM."),(0,o.kt)("admonition",{title:"Saving a file as XBM in Gimp",type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"To save as an XBM in Gimp, use CTRL-SHIFT-E (export). Change the filename in the\nsubsequent window so that it ends in ",(0,o.kt)("inlineCode",{parentName:"p"},".xbm")," and Gimp will automatically perform\nthe conversion.")),(0,o.kt)("h3",{id:"upload-and-convert-to-a-header-file"},"Upload and convert to a header file"),(0,o.kt)("p",null,"Use the left sidebar menu on the Kasm desktop to upload your XBM file. From the\n",(0,o.kt)("inlineCode",{parentName:"p"},"nametag")," directory, use the helper script to convert this to a c header file."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"cd ~/Desktop/magtag-training/nametag\npython ../utility/xbm_to_header.py ~/Desktop/Uploads/my_magtag_background.xbm\n")),(0,o.kt)("h3",{id:"show-the-header-file-and-write-your-tex"},"Show the header file and write your tex"),(0,o.kt)("p",null,"The previous step should result in a header file with the same filename as the\ninput (",(0,o.kt)("inlineCode",{parentName:"p"},"my_magtag_background.h"),") that includes an array of the same name\ncontaining the background image data. Let's include that file and show how to\nuse it."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-c"},'#include "../my_magtag_background.h"\n\n/**\n * @brief Unused function awaiting workshop user customization\n */\nvoid nametag_training_challenge(void) {\n    if (k_mutex_lock(&epaper_mutex, K_SECONDS(1))!=0) {\n        /* ePaper already in use, abort */\n        return;\n    }\n\n    /* Perform a full-refresh on the display */\n    epaper_FullClear();\n\n    /* Use a partial write to draw the background */\n    /* Change frame3 to the name of your array */\n    epaper_ShowFullFrame(frame3);\n\n    /* Write text on top of the background */\n    epaper_Write(_myname, strlen(_myname), 2, CENTER, 4);\n    epaper_WriteInverted(_title, strlen(_title), 11, CENTER, 2);\n    epaper_WriteInverted(_handle, strlen(_handle), 13, CENTER, 2);\n\n    k_mutex_unlock(&epaper_mutex);\n}\n')),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"epaper_Write()/epaper_WriteInverted()")," functions allow you place your own\ntext on the display. Supply parameters as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-c"},"epaper_Write(_myname,           /* String to display          */\n             strlen(_myname),   /* length of string           */\n             2,                 /* row; 0=top, 15=bottom      */\n             CENTER,  /* column; 295=left, 0=right            */\n             4);      /* Column height of letters (1,2, or 4) */\n")),(0,o.kt)("p",null,"The column value also has special values. ",(0,o.kt)("inlineCode",{parentName:"p"},"FULL_WIDTH")," uses the full screen\nwidth, left justified and ",(0,o.kt)("inlineCode",{parentName:"p"},"CENTER")," centers the text on screen."),(0,o.kt)("p",null,"The final step is to call your custom function. Find the part of the main.c file\nwhere button presses are used to update the display and replace on with your\n",(0,o.kt)("inlineCode",{parentName:"p"},"nametag_training_challenge()")," function call."),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Show me where to call this function"),(0,o.kt)("p",null,"Search for the following code in the ",(0,o.kt)("inlineCode",{parentName:"p"},"nametag/src/main.c")," file."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-c"},"/* Update the ePaper frame */\nswitch(i) {\n    case 1:\n        nametag_green();\n        break;\n    case 2:\n        nametag_blue();\n        break;\n    case 3:\n        nametag_yellow();\n        break;\n    case 4:\n        nametag_rainbow();\n        break;\n    default:\n        nametag_red();\n}\n")),(0,o.kt)("p",null,"Replace any of the nametag function calls with your custom functions. Just note\nthat the ",(0,o.kt)("inlineCode",{parentName:"p"},"nametag_rainbow()")," function is what is used to connect to Golioth to\ndownload name/title/handle updates at boot time.")),(0,o.kt)("h3",{id:"build-and-flash-your-changes"},"Build and flash your changes"),(0,o.kt)("p",null,"With your custom image and text layout in place, follow the directions on the\ntop of this page to compile and flash the new code."))}h.isMDXComponent=!0},1403:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/kasm_download_binary-4769c026b5cdf800e547216fa265501c.png"},8606:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/magtag-bootloader-mode-5c7952ae3bb40ddc89a40e0f41cf721f.jpg"},2929:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/nametag-display-7d9da2b5683f4e8df9fa3b7e4570a669.jpg"},9501:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/nametag-endpoints-e2d4b7895ba9b21ef4545690d0198a04.png"}}]);